<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Molam Admin - Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <div class="login-header">
                <div class="logo">üîê</div>
                <h1>Molam Admin</h1>
                <p>Panneau d'administration</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" value="admin@molam.sn" required>
                </div>
                <div class="form-group">
                    <label for="password">Mot de passe</label>
                    <input type="password" id="password" name="password" value="SuperSecure123!" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">
                    Se connecter
                </button>
                <div id="loginError" class="error-message" style="display: none;"></div>
            </form>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboardScreen" class="screen">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo-small">üîê</div>
                <h2>Molam Admin</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-page="dashboard">
                    <span class="icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-page="users">
                    <span class="icon">üë•</span>
                    <span>Utilisateurs</span>
                </a>
                <a href="#" class="nav-item" data-page="roles">
                    <span class="icon">üé≠</span>
                    <span>R√¥les</span>
                </a>
                <a href="#" class="nav-item" data-page="audit">
                    <span class="icon">üìú</span>
                    <span>Audit</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">üë§</div>
                    <div class="user-details">
                        <div class="user-name" id="adminName">Admin</div>
                        <div class="user-email" id="adminEmail"></div>
                    </div>
                </div>
                <button class="btn btn-secondary btn-block" onclick="logout()">
                    D√©connexion
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <h1 id="pageTitle">Dashboard</h1>
                <div class="header-actions">
                    <button class="btn btn-icon" onclick="refreshData()">üîÑ</button>
                </div>
            </div>

            <!-- Dashboard Page -->
            <div id="dashboardPage" class="page active">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-content">
                            <div class="stat-label">Total Utilisateurs</div>
                            <div class="stat-value" id="totalUsers">-</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-content">
                            <div class="stat-label">Utilisateurs Actifs</div>
                            <div class="stat-value" id="activeUsers">-</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚è≥</div>
                        <div class="stat-content">
                            <div class="stat-label">En Attente</div>
                            <div class="stat-value" id="pendingUsers">-</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üÜï</div>
                        <div class="stat-content">
                            <div class="stat-label">Nouveaux (7j)</div>
                            <div class="stat-value" id="newUsers">-</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Users -->
                <div class="card">
                    <div class="card-header">
                        <h3>Utilisateurs r√©cents</h3>
                    </div>
                    <div class="card-body">
                        <div id="recentUsers" class="table-container"></div>
                    </div>
                </div>
            </div>

            <!-- Users Page -->
            <div id="usersPage" class="page">
                <div class="page-actions">
                    <input type="text" id="userSearch" placeholder="Rechercher un utilisateur..." class="search-input">
                    <button class="btn btn-primary" onclick="showCreateUserModal()">
                        ‚ûï Nouvel utilisateur
                    </button>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div id="usersTable" class="table-container"></div>
                    </div>
                </div>

                <div class="pagination" id="usersPagination"></div>
            </div>

            <!-- Roles Page -->
            <div id="rolesPage" class="page">
                <div class="page-actions">
                    <button class="btn btn-primary" onclick="showCreateRoleModal()">
                        ‚ûï Nouveau r√¥le
                    </button>
                </div>

                <div class="roles-grid" id="rolesGrid"></div>
            </div>

            <!-- Audit Page -->
            <div id="auditPage" class="page">
                <div class="card">
                    <div class="card-header">
                        <h3>Journal d'audit</h3>
                    </div>
                    <div class="card-body">
                        <div id="auditTable" class="table-container"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="createUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cr√©er un utilisateur</h3>
                <button class="modal-close" onclick="closeModal('createUserModal')">&times;</button>
            </div>
            <form id="createUserForm" class="modal-body">
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Pr√©nom</label>
                    <input type="text" name="firstName" placeholder="Jean">
                </div>
                <div class="form-group">
                    <label>Nom</label>
                    <input type="text" name="lastName" placeholder="Dupont">
                </div>
                <div class="form-group">
                    <label>T√©l√©phone</label>
                    <input type="tel" name="phone" placeholder="+221771234567">
                </div>
                <div class="form-group">
                    <label>Mot de passe *</label>
                    <input type="password" name="password" required minlength="8">
                </div>
                <div class="form-group">
                    <label>R√¥le</label>
                    <select name="role">
                        <option value="client">Client</option>
                        <option value="merchant">Merchant</option>
                        <option value="agent">Agent</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Statut</label>
                    <select name="status">
                        <option value="active">Actif</option>
                        <option value="pending">En attente</option>
                        <option value="suspended">Suspendu</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createUserModal')">
                        Annuler
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Cr√©er
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="uploadPhotoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>T√©l√©charger une photo de profil</h3>
                <button class="modal-close" onclick="closeModal('uploadPhotoModal')">&times;</button>
            </div>
            <form id="uploadPhotoForm" class="modal-body">
                <input type="hidden" id="uploadPhotoUserId" name="userId">
                <div class="form-group">
                    <label>Photo de profil *</label>
                    <input type="file" name="photo" accept="image/*" required>
                    <small style="color: var(--text-light); margin-top: 5px; display: block;">
                        Formats accept√©s: JPG, PNG, GIF, WebP (max 5MB)
                    </small>
                </div>
                <div id="photoPreview" style="margin-top: 15px; text-align: center;"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('uploadPhotoModal')">
                        Annuler
                    </button>
                    <button type="submit" class="btn btn-primary">
                        T√©l√©charger
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="editUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Modifier l'utilisateur</h3>
                <button class="modal-close" onclick="closeModal('editUserModal')">&times;</button>
            </div>
            <form id="editUserForm" class="modal-body">
                <input type="hidden" id="editUserId" name="userId">
                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" id="editUserEmail" name="email" required>
                </div>
                <div class="form-group">
                    <label>Pr√©nom</label>
                    <input type="text" id="editUserFirstName" name="firstName" placeholder="Jean">
                </div>
                <div class="form-group">
                    <label>Nom</label>
                    <input type="text" id="editUserLastName" name="lastName" placeholder="Dupont">
                </div>
                <div class="form-group">
                    <label>T√©l√©phone</label>
                    <input type="tel" id="editUserPhone" name="phone" placeholder="+221771234567">
                </div>
                <div class="form-group">
                    <label>Statut</label>
                    <select id="editUserStatus" name="status">
                        <option value="active">Actif</option>
                        <option value="pending">En attente</option>
                        <option value="suspended">Suspendu</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('editUserModal')">
                        Annuler
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Enregistrer
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="createRoleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cr√©er un r√¥le</h3>
                <button class="modal-close" onclick="closeModal('createRoleModal')">&times;</button>
            </div>
            <form id="createRoleForm" class="modal-body">
                <div class="form-group">
                    <label>Nom du r√¥le *</label>
                    <input type="text" name="role_name" required>
                </div>
                <div class="form-group">
                    <label>Nom d'affichage *</label>
                    <input type="text" name="display_name" required>
                </div>
                <div class="form-group">
                    <label>Module</label>
                    <select name="module">
                        <option value="*">Global</option>
                        <option value="pay">Pay</option>
                        <option value="eats">Eats</option>
                        <option value="shop">Shop</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea name="description" rows="3"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createRoleModal')">
                        Annuler
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Cr√©er
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="app.js"></script>
</body>
</html>
