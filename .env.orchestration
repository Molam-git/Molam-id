# =============================================================================
# MOLAM-ID - CONFIGURATION D'ORCHESTRATION COMPLÈTE
# =============================================================================
# Ce fichier contient toutes les variables d'environnement pour les 33 briques
# IMPORTANT: Ne jamais commiter ce fichier en production avec des vraies valeurs
# =============================================================================

# ===========================================================================
# INFRASTRUCTURE PARTAGÉE
# ===========================================================================

# PostgreSQL
POSTGRES_USER=molam
POSTGRES_PASSWORD=molam_pass
POSTGRES_DB=molam
DATABASE_URL=postgresql://molam:molam_pass@postgres:5432/molam

# Redis
REDIS_URL=redis://redis:6379

# Kafka
KAFKA_BROKERS=kafka:29092
KAFKA_ENABLED=true

# ===========================================================================
# JWT & SÉCURITÉ
# ===========================================================================

# JWT Secrets (CHANGER EN PRODUCTION!)
JWT_SECRET=votre_secret_jwt_super_securise_changez_moi_en_production
JWT_REFRESH_SECRET=votre_refresh_secret_super_securise_changez_moi_en_production

# JWT Configuration
JWT_AUDIENCE=molam-id
JWT_ISSUER=https://id.molam.com

# JWT Public Key (pour vérification par les microservices)
# Générer avec: openssl genrsa -out private.pem 2048 && openssl rsa -in private.pem -pubout -out public.pem
JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA... (remplacer par votre clé)
-----END PUBLIC KEY-----"

# ===========================================================================
# AWS & CLOUD SERVICES
# ===========================================================================

AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_access_key_here
AWS_SECRET_ACCESS_KEY=your_secret_key_here

# S3 Buckets
S3_BUCKET_VOICE=molam-voice-auth
S3_BUCKET_AUDIT=molam-audit-logs
S3_BUCKET_I18N=molam-i18n-bundles
S3_BUCKET_AVATARS=molam-avatars
S3_BUCKET_EXPORTS=molam-profile-exports

# KMS
AWS_KMS_KEY_ID=your_kms_key_id_here

# ===========================================================================
# SERVICES EXTERNES
# ===========================================================================

# MaxMind GeoIP2
MAXMIND_LICENSE_KEY=your_maxmind_license_key_here

# Voice ML Service
VOICE_ML_URL=http://voice-ml:9000

# SIRA (Risk Analysis)
SIRA_ENABLED=true
SIRA_URL=http://sira:8080

# Audit Service
AUDIT_SERVICE_URL=http://id-audit:3014

# ===========================================================================
# BRIQUE 6: PASSWORD RESET
# ===========================================================================

# Email/SMS providers (à configurer selon votre fournisseur)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=noreply@molam.com
SMTP_PASSWORD=your_smtp_password
SMS_PROVIDER=twilio
SMS_API_KEY=your_sms_api_key

# ===========================================================================
# BRIQUE 7: BIOMETRICS (WebAuthn)
# ===========================================================================

WEBAUTHN_RP_NAME=Molam ID
WEBAUTHN_RP_ID=id.molam.com
WEBAUTHN_ORIGIN=https://id.molam.com

# ===========================================================================
# BRIQUE 8: VOICE AUTH
# ===========================================================================

MAX_AUDIO_SEC=30
VOICE_SAMPLE_RATE=16000

# ===========================================================================
# BRIQUE 11: MFA/2FA
# ===========================================================================

MFA_ISSUER=Molam ID
TOTP_WINDOW=1
TOTP_STEP=30

# ===========================================================================
# BRIQUE 22: ADMIN ID (Vault)
# ===========================================================================

VAULT_ENABLED=false
VAULT_ADDR=http://vault:8200
VAULT_TOKEN=your_vault_token_here

# ===========================================================================
# OBSERVABILITÉ & MONITORING
# ===========================================================================

# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_PORT=3100

# Logging Level
LOG_LEVEL=info

# ===========================================================================
# CONFIGURATION PAR ENVIRONNEMENT
# ===========================================================================

NODE_ENV=production

# Mode Debug (mettre à false en production)
DEBUG=false

# ===========================================================================
# PORTS DES SERVICES (pour référence)
# ===========================================================================

# Core Services
# PORT_GATEWAY=3000
# PORT_ID_CORE=3001

# Authentication & Security Services (Briques 6-11)
# PORT_PASSWORD_RESET=8085
# PORT_BIOMETRICS=8080
# PORT_VOICE_AUTH=8081
# PORT_GEO=3009
# PORT_DEVICE=8083
# PORT_MFA=8084

# Delegation & Control Services (Briques 12-15)
# PORT_DELEGATION=3012
# PORT_BLACKLIST=3013
# PORT_AUDIT=3014
# PORT_I18N=3015

# Data & Profile Services (Briques 16-19)
# PORT_FX=3016
# PORT_PROFILE=3017
# PORT_UPDATE_PROFILE=3018
# PORT_EXPORT_PROFILE=3019

# RBAC & Authorization Services (Briques 20-23)
# PORT_RBAC_GRANULAR=3020
# PORT_ROLE_MGMT=3021
# PORT_ADMIN_ID=3022
# PORT_SESSIONS_MONITORING=3023

# Admin API (Brique 33)
# PORT_API_ADMIN=3033

# ===========================================================================
# NOTES IMPORTANTES
# ===========================================================================

# 1. SÉCURITÉ:
#    - Changer TOUS les secrets en production
#    - Utiliser un gestionnaire de secrets (Vault, AWS Secrets Manager)
#    - Ne jamais exposer ce fichier publiquement

# 2. SERVICES CLOUD:
#    - Configurer AWS IAM avec les permissions minimales
#    - Activer le chiffrement S3
#    - Utiliser KMS pour les données sensibles

# 3. BASES DE DONNÉES:
#    - Utiliser des mots de passe forts en production
#    - Activer SSL/TLS pour PostgreSQL
#    - Configurer des backups automatiques

# 4. MONITORING:
#    - Activer Prometheus pour toutes les briques
#    - Configurer des alertes dans Grafana
#    - Centraliser les logs (ELK, CloudWatch, etc.)

# 5. MISE À L'ÉCHELLE:
#    - Chaque brique peut être scalée indépendamment
#    - Utiliser un load balancer devant l'API Gateway
#    - Considérer Kubernetes pour la production
